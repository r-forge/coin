
library("wilcox")

p1 <- .pwilcox(0:20, sizes = c(5, 4), exact = TRUE)
p2 <- .pwilcox(0:20, sizes = c(5, 4), z = 1:9, exact = TRUE)
all.equal(p1, p2)
p3 <- pwilcox(0:20, 5, 4)
all.equal(p1, p3)
p1 <- .pwilcox(0:20, sizes = c(5, 4), exact = FALSE, simulate = FALSE)
p2 <- .pwilcox(0:20, sizes = c(5, 4), z = 1:9, exact = FALSE, simulate = FALSE)
all.equal(p1, p2)
p3 <- .pwilcox(0:20, sizes = c(5, 4), z = 1:9, exact = FALSE, simulate = FALSE, conditional = TRUE)
all.equal(p2, p3)
p1 <- .pwilcox(0:20, sizes = c(5, 4), exact = FALSE, simulate = TRUE, B = 1e5)
p2 <- .pwilcox(0:20, sizes = c(5, 4), z = 1:9, exact = FALSE, simulate = TRUE, B = 1e5)
all.equal(p1, p2)

q1 <- .qwilcox(0:20 / 20, sizes = c(5, 4), exact = TRUE)
q2 <- .qwilcox(0:20 / 20, sizes = c(5, 4), z = 1:9, exact = TRUE)
all.equal(q1, q2)
q3 <- qwilcox(0:20 / 20, 5, 4)
all.equal(q1, q3)
q1 <- .qwilcox(0:20 / 20, sizes = c(5, 4), exact = FALSE, simulate = FALSE)
q2 <- .qwilcox(0:20 / 20, sizes = c(5, 4), z = 1:9, exact = FALSE, simulate = FALSE)
all.equal(q1, q2)
q1 <- .qwilcox(0:20 / 20, sizes = c(5, 4), exact = FALSE, simulate = TRUE)
q2 <- .qwilcox(0:20 / 20, sizes = c(5, 4), z = 1:9, exact = FALSE, simulate = TRUE)
all.equal(q1, q2)


d1 <- .dwilcox(0:20, sizes = c(5, 4))
d2 <- .dwilcox(0:20, sizes = c(5, 4), z = 1:9)
all.equal(d1, d2)
d3 <- dwilcox(0:20, 5, 4)
all.equal(d1, d3)

r1 <- .rwilcox(1e5, sizes = c(5, 4))
r2 <- .rwilcox(1e5, sizes = c(5, 4), z = 1:9)
all.equal(ecdf(r1)(0:20), ecdf(r2)(0:20))

z <- rank(y <- sample(1:3, size = 9, replace = TRUE))
g <- rep(gl(2, 1), c(5, 4))
p1 <- .pwilcox(0:20, sizes = c(5, 4), z = z, exact = TRUE)
p2 <- .pwilcox(0:20, sizes = c(5, 4), z = z, exact = FALSE, simulate = TRUE, B = 1e5)
all.equal(p1, p2)

q1 <- .qwilcox(0:20 / 20, sizes = c(5, 4), z = z, exact = TRUE)
q2 <- .qwilcox(0:20 / 20, sizes = c(5, 4), z = z, exact = FALSE, simulate = TRUE, B = 1e5)
all.equal(q1, q2)

