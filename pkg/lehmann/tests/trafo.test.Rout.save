
R version 4.5.0 (2025-04-11) -- "How About a Twenty-Six"
Copyright (C) 2025 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> 
> library("lehmann")
> library("rms")
Loading required package: Hmisc

Attaching package: 'Hmisc'

The following objects are masked from 'package:base':

    format.pval, units

> library("survival")
> 
> set.seed(29)
> 
> N <- 500
> x <- gl(2, N)
> y <- rlogis(length(x), location = c(0, 2)[x])
> 
> ci <- confint(m <- orm(y ~ x))
> c(rev(coef(m))[1], ci[nrow(ci),])
     x=2    2.5 %   97.5 % 
1.921277 1.679687 2.162867 
> 
> d <- data.frame(y = y, x = x)
> 
> trafo.test(y = y, x = x)

	Semiparametric two-sample Wald inference for proportional odds models

data:  x and y
Wald Z = 15.547, p-value < 2.2e-16
alternative hypothesis: true log-odds ratio is not equal to 0
95 percent confidence interval:
 1.674251 2.157292
sample estimates:
log-odds ratio  
       1.915771 

Warning message:
In trafo.test.table(tab, ...) : NEW_X
> trafo.test(y ~ x, data = d)

	Semiparametric two-sample Wald inference for proportional odds models

data:  y by x
Wald Z = 15.547, p-value < 2.2e-16
alternative hypothesis: true log-odds ratio is not equal to 0
95 percent confidence interval:
 1.674251 2.157292
sample estimates:
log-odds ratio  
       1.915771 

Warning message:
In trafo.test.table(tab, ...) : NEW_X
> trafo.test(y = y, x = x, nbins = 99)

	Semiparametric two-sample Wald inference for proportional odds models

data:  x and y
Wald Z = 15.591, p-value < 2.2e-16
alternative hypothesis: true log-odds ratio is not equal to 0
95 percent confidence interval:
 1.680529 2.163790
sample estimates:
log-odds ratio  
       1.922159 

> trafo.test(y = y, x = x, nbins = 100)

	Semiparametric two-sample Wald inference for proportional odds models

data:  x and y
Wald Z = 15.581, p-value < 2.2e-16
alternative hypothesis: true log-odds ratio is not equal to 0
95 percent confidence interval:
 1.678827 2.161975
sample estimates:
log-odds ratio  
       1.920401 

> 
> -coef(m <- coxph(Surv(y, rep(TRUE, length(y))) ~ x))
       x2 
0.9865179 
> -rev(confint(m))
[1] 0.8564659 1.1165698
> ### rms: cloglog for P(Y < y) is loglog for P(Y >= y), the latter
> ### being used in orm()
> ci <- confint(m <- orm(y ~ x, family = "loglog"))
> c(rev(coef(m))[1], ci[nrow(ci),])
      x=2     2.5 %    97.5 % 
0.9879509 0.8578866 1.1180153 
> 
> trafo.test(y = y, x = x, link = "cloglog")

	Semiparametric two-sample Wald inference for proportional hazards
	models

data:  x and y
Wald Z = 14.833, p-value < 2.2e-16
alternative hypothesis: true log-hazard ratio is not equal to 0
95 percent confidence interval:
 0.8549403 1.1152828
sample estimates:
log-hazard ratio  
        0.9851116 

Warning message:
In trafo.test.table(tab, ...) : NEW_X
> trafo.test(y = y, x = x, link = "cloglog", nbins = 99)

	Semiparametric two-sample Wald inference for proportional hazards
	models

data:  x and y
Wald Z = 14.893, p-value < 2.2e-16
alternative hypothesis: true log-hazard ratio is not equal to 0
95 percent confidence interval:
 0.8615966 1.1227386
sample estimates:
log-hazard ratio  
        0.9921676 

Warning message:
In trafo.test.table(tab, ...) : NEW_X
> trafo.test(y = y, x = x, link = "cloglog", nbins = 100)

	Semiparametric two-sample Wald inference for proportional hazards
	models

data:  x and y
Wald Z = 14.934, p-value < 2.2e-16
alternative hypothesis: true log-hazard ratio is not equal to 0
95 percent confidence interval:
 0.8643064 1.1254441
sample estimates:
log-hazard ratio  
        0.9948753 

Warning message:
In trafo.test.table(tab, ...) : NEW_X
> 
> ci <- confint(m <- orm(y ~ x, family = "cloglog"))
> c(rev(coef(m))[1], ci[nrow(ci),])
      x=2     2.5 %    97.5 % 
0.9454023 0.8164097 1.0743950 
> 
> trafo.test(y = y, x = x, link = "loglog")

	Semiparametric two-sample Wald inference for Lehmann alternative models

data:  x and y
Wald Z = 14.475, p-value < 2.2e-16
alternative hypothesis: true log-reverse time hazard ratio is not equal to 0
95 percent confidence interval:
 0.8234118 1.0813120
sample estimates:
log-reverse time hazard ratio  
                     0.9523619 

Warning message:
In trafo.test.table(tab, ...) : NEW_X
> trafo.test(y = y, x = x, link = "loglog", nbins = 99)

	Semiparametric two-sample Wald inference for Lehmann alternative models

data:  x and y
Wald Z = 14.39, p-value < 2.2e-16
alternative hypothesis: true log-reverse time hazard ratio is not equal to 0
95 percent confidence interval:
 0.821052 1.079973
sample estimates:
log-reverse time hazard ratio  
                     0.9505127 

> trafo.test(y = y, x = x, link = "loglog", nbins = 100)

	Semiparametric two-sample Wald inference for Lehmann alternative models

data:  x and y
Wald Z = 14.381, p-value < 2.2e-16
alternative hypothesis: true log-reverse time hazard ratio is not equal to 0
95 percent confidence interval:
 0.8205812 1.0795378
sample estimates:
log-reverse time hazard ratio  
                     0.9500595 

> 
> ### with offset
> mu <- 1
> off <- (x == levels(x)[2]) * mu
> 
> ci <- confint(m <- orm(y ~ x + offset(off)))
> c(rev(coef(m))[1], ci[nrow(ci),])
      x=2     2.5 %    97.5 % 
0.9212769 0.6796872 1.1628666 
> 
> trafo.test(y = y, x = x, mu = 1)

	Semiparametric two-sample Wald inference for proportional odds models

data:  x and y
Wald Z = 7.4526, p-value = 9.155e-14
alternative hypothesis: true log-odds ratio is not equal to 1
95 percent confidence interval:
 0.6769578 1.1600861
sample estimates:
log-odds ratio -1 
        0.9185219 

Warning message:
In trafo.test.table(tab, ...) : NEW_X
> trafo.test(y = y, x = x, mu = 1, nbins = 99)

	Semiparametric two-sample Wald inference for proportional odds models

data:  x and y
Wald Z = 7.4777, p-value = 7.561e-14
alternative hypothesis: true log-odds ratio is not equal to 1
95 percent confidence interval:
 0.6802495 1.1635113
sample estimates:
log-odds ratio -1 
        0.9218804 

> trafo.test(y = y, x = x, mu = 1, nbins = 100)

	Semiparametric two-sample Wald inference for proportional odds models

data:  x and y
Wald Z = 7.4632, p-value = 8.443e-14
alternative hypothesis: true log-odds ratio is not equal to 1
95 percent confidence interval:
 0.6782578 1.1613758
sample estimates:
log-odds ratio -1 
        0.9198168 

> 
> ### permutations
> N <- 15
> x <- gl(2, N)
> y <- rlogis(length(x), location = c(0, 2)[x])
> 
> ci <- confint(m <- orm(y ~ x))
> c(rev(coef(m))[1], ci[nrow(ci),])
       x=2      2.5 %     97.5 % 
 1.0671231 -0.2207782  2.3550243 
> 
> trafo.test(y = y, x = x)

	Semiparametric two-sample Wald inference for proportional odds models

data:  x and y
Wald Z = 1.6237, p-value = 0.1044
alternative hypothesis: true log-odds ratio is not equal to 0
95 percent confidence interval:
 -0.2209624  2.3548221
sample estimates:
log-odds ratio  
        1.06693 

> trafo.test(y = y, x = x, inference = "MLScore")

	Semiparametric two-sample score inference for proportional odds models

data:  x and y
Score Z = -1.6397, p-value = 0.1011
alternative hypothesis: true log-odds ratio is not equal to 0
95 percent confidence interval:
 -0.2033291  2.3393149
sample estimates:
log-odds ratio  
        1.06693 

> trafo.test(y = y, x = x, inference = "LRatio")

	Semiparametric two-sample LR inference for proportional odds models

data:  x and y
LR Chisq = 2.7131, p-value = 0.09952
alternative hypothesis: true log-odds ratio is not equal to 0
95 percent confidence interval:
 -0.2005977  2.3929380
sample estimates:
log-odds ratio  
        1.06693 

> trafo.test(y = y, x = x, inference = "PermScore", B = 0)

	Semiparametric two-sample asymptotic permutation inference for
	proportional odds models

data:  x and y
Score Z = -1.6395, p-value = 0.1103
alternative hypothesis: true log-odds ratio is not equal to 0
95 percent confidence interval:
 -0.2364287  2.3722670
sample estimates:
log-odds ratio  
        1.06693 

> trafo.test(y = y, x = x, inference = "PermScore", B = 10000)

	Semiparametric two-sample approximate permutation inference for
	proportional odds models

data:  x and y
Score Z = -1.6395, p-value = 0.1123
alternative hypothesis: true log-odds ratio is not equal to 0
95 percent confidence interval:
 -0.2429396  2.3790876
sample estimates:
log-odds ratio  
        1.06693 

> trafo.test(y = y, x = x, inference = "PermScore", B = Inf)

	Semiparametric two-sample exact (Wilcoxon) permutation inference for
	proportional odds models

data:  x and y
U = 151, p-value = 0.116
alternative hypothesis: true log-odds ratio is not equal to 0
95 percent confidence interval:
 -0.2429396  2.3790876
sample estimates:
log-odds ratio  
        1.06693 

> 
> proc.time()
   user  system elapsed 
  1.838   0.085   1.919 
