
R Under development (unstable) (2026-01-21 r89314) -- "Unsuffered Consequences"
Copyright (C) 2026 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> 
> library("coin")
Loading required package: survival
> library("free1way")
> 
> jstab <- jobsatisfaction
> 
> js <- as.data.frame(jstab)
> js$Job.Satisfaction <- ordered(js$Job.Satisfaction,
+       levels = dimnames(jstab)[[2]],
+       labels = dimnames(jstab)[[2]])
> js$jsnum <- unclass(js$Job.Satisfaction)
> 
> jsall <- js[rep(1:nrow(js), js$Freq),]
> 
> ### all the same
> free1way(Job.Satisfaction ~ Income | Gender, data = jsall)

	Stratified 4-sample Kruskal-Wallis test against proportional odds
	alternatives

data:  Job.Satisfaction by Income (<5000, 5000-15000, 15000-25000, >25000) 
	 stratified by Gender
Perm chi-squared = 8.4697, df = 3, p-value = 0.03724
alternative hypothesis: true log-odds ratio is not equal to 0

> free1way(jsnum ~ Income | Gender, data = jsall)

	Stratified 4-sample Kruskal-Wallis test against proportional odds
	alternatives

data:  jsnum by Income (<5000, 5000-15000, 15000-25000, >25000) 
	 stratified by Gender
Perm chi-squared = 8.4697, df = 3, p-value = 0.03724
alternative hypothesis: true log-odds ratio is not equal to 0

> kruskal_test(jsnum ~ Income | Gender, data = jsall)

	Asymptotic Kruskal-Wallis Test

data:  jsnum by
	 Income (<5000, 5000-15000, 15000-25000, >25000) 
	 stratified by Gender
chi-squared = 8.742, df = 3, p-value = 0.03293

> free1way(Job.Satisfaction ~ Income | Gender, data = js, weights = Freq)

	Stratified 4-sample Kruskal-Wallis test against proportional odds
	alternatives

data:  Job.Satisfaction by Income (<5000, 5000-15000, 15000-25000, >25000) 
	 stratified by Gender
Perm chi-squared = 8.4697, df = 3, p-value = 0.03724
alternative hypothesis: true log-odds ratio is not equal to 0

> free1way(jsnum ~ Income | Gender, data = js, weights = Freq)

	Stratified 4-sample Kruskal-Wallis test against proportional odds
	alternatives

data:  jsnum by Income (<5000, 5000-15000, 15000-25000, >25000) 
	 stratified by Gender
Perm chi-squared = 8.4697, df = 3, p-value = 0.03724
alternative hypothesis: true log-odds ratio is not equal to 0

> free1way(aperm(jstab, perm = c(2, 1, 3)))

	Stratified 4-sample Kruskal-Wallis test against proportional odds
	alternatives

data:  Job.Satisfaction by Income (c("<5000", "5000-15000", "15000-25000", ">25000")) 
	 stratified by Gender
Perm chi-squared = 8.4697, df = 3, p-value = 0.03724
alternative hypothesis: true log-odds ratio is not equal to 0

> 
> ### w/o coin
> example(mantelhaen.test, echo = FALSE)
> (ft <- free1way(aperm(Satisfaction, perm = c(2, 1, 3))))

	Stratified 4-sample Kruskal-Wallis test against proportional odds
	alternatives

data:  Job Satisfaction by Income (c("<5000", "5000-15000", "15000-25000", ">25000")) 
	 stratified by Gender
Perm chi-squared = 8.4697, df = 3, p-value = 0.03724
alternative hypothesis: true log-odds ratio is not equal to 0

> 
> ### post-hoc
> library("multcomp")
Loading required package: mvtnorm
Loading required package: TH.data
Loading required package: MASS

Attaching package: 'TH.data'

The following object is masked from 'package:MASS':

    geyser

> glht(ft, linfct = mcp(Income = "Dunnett"))

	 General Linear Hypotheses

Multiple Comparisons of Means: Dunnett Contrasts


Linear Hypotheses:
                         Estimate
5000-15000 - <5000 == 0    0.1079
15000-25000 - <5000 == 0   1.4600
>25000 - <5000 == 0        1.2328

> 
> proc.time()
   user  system elapsed 
  0.868   0.056   0.920 
