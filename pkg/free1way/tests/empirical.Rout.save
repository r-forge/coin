
R Under development (unstable) (2025-08-22 r88676) -- "Unsuffered Consequences"
Copyright (C) 2025 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> 
> library("free1way")
> library("rms")
Loading required package: Hmisc

Attaching package: 'Hmisc'

The following objects are masked from 'package:base':

    format.pval, units

> library("survival")
> 
> set.seed(29)
> 
> N <- 500
> x <- gl(2, N)
> y <- rlogis(length(x), location = c(0, 2)[x])
> 
> ci <- confint(m <- orm(y ~ x))
> c(rev(coef(m))[1], ci[nrow(ci),])
     x=2    2.5 %   97.5 % 
1.921277 1.679687 2.162867 
> logLik(m)
'log Lik.' -6774.86 (df=1000)
> 
> d <- data.frame(y = y, x = x)
> 
> (ft <- free1way(y = y, groups = x))

	2-sample Wilcoxon test against proportional odds alternatives

data:  y by x (1, 2)
Perm Z = 15.608, p-value < 2.2e-16
alternative hypothesis: true log-odds ratio is not equal to 0

> coef(ft)
      x2 
1.921266 
> confint(ft)
      2.5 %   97.5 %
x2 1.672371 2.169817
> logLik(ft)
[1] -6774.86
> (ft <- free1way(y ~ x, data = d))

	2-sample Wilcoxon test against proportional odds alternatives

data:  y by x (1, 2)
Perm Z = 15.608, p-value < 2.2e-16
alternative hypothesis: true log-odds ratio is not equal to 0

> (ft <- free1way(y = y, groups = x, nbins = 99))

	2-sample Wilcoxon test against proportional odds alternatives

data:  y by x (1, 2)
Perm Z = 15.614, p-value < 2.2e-16
alternative hypothesis: true log-odds ratio is not equal to 0

> (ft <- free1way(y = y, groups = x, nbins = 100))

	2-sample Wilcoxon test against proportional odds alternatives

data:  y by x (1, 2)
Perm Z = 15.602, p-value < 2.2e-16
alternative hypothesis: true log-odds ratio is not equal to 0

> 
> -coef(m <- coxph(Surv(y, rep(TRUE, length(y))) ~ x))
       x2 
0.9865179 
> -rev(confint(m))
[1] 0.8564659 1.1165698
> ### rms: cloglog for P(Y < y) is loglog for P(Y >= y), the latter
> ### being used in orm()
> ci <- confint(m <- orm(y ~ x, family = "loglog"))
> c(rev(coef(m))[1], ci[nrow(ci),])
      x=2     2.5 %    97.5 % 
0.9879509 0.8578866 1.1180153 
> logLik(m)
'log Lik.' -6800.012 (df=1000)
> 
> ft <- free1way(y = y, groups = x, link = "cloglog")
> coef(ft)
       x2 
0.9878949 
> confint(ft)
      2.5 %   97.5 %
x2 0.838895 1.136918
> logLik(ft)
[1] -6800.012
> ft <- free1way(y = y, groups = x, link = "cloglog", nbins = 99)
> coef(ft)
       x2 
0.9943897 
> confint(ft)
       2.5 %   97.5 %
x2 0.8451693 1.143522
> ft <- free1way(y = y, groups = x, link = "cloglog", nbins = 100)
> coef(ft)
       x2 
0.9932806 
> confint(ft)
       2.5 %   97.5 %
x2 0.8440277 1.142394
> 
> ci <- confint(m <- orm(y ~ x, family = "cloglog"))
> c(rev(coef(m))[1], ci[nrow(ci),])
      x=2     2.5 %    97.5 % 
0.9454023 0.8164097 1.0743950 
> logLik(m)
'log Lik.' -6807.335 (df=1000)
> 
> ft <- free1way(y = y, groups = x, link = "loglog")
> coef(ft)
       x2 
0.9454868 
> confint(ft)
       2.5 %   97.5 %
x2 0.7993042 1.091464
> logLik(ft)
[1] -6807.335
> ft <- free1way(y = y, groups = x, link = "loglog", nbins = 99)
> coef(ft)
       x2 
0.9503941 
> confint(ft)
       2.5 %   97.5 %
x2 0.8044777 1.096523
> ft <- free1way(y = y, groups = x, link = "loglog", nbins = 100)
> coef(ft)
       x2 
0.9505176 
> confint(ft)
       2.5 %  97.5 %
x2 0.8046361 1.09674
> 
> ### probit
> ci <- confint(m <- orm(y ~ x, family = "probit"))
> c(rev(coef(m))[1], ci[nrow(ci),])
      x=2     2.5 %    97.5 % 
1.0872527 0.9539179 1.2205875 
> logLik(m)
'log Lik.' -6779.161 (df=1000)
> 
> ft <- free1way(y = y, groups = x, link = "probit")
> coef(ft)
      x2 
1.087242 
> confint(ft)
       2.5 %   97.5 %
x2 0.9452306 1.229297
> logLik(ft)
[1] -6779.161
> ft <- free1way(y = y, groups = x, link = "probit", nbins = 99)
> coef(ft)
      x2 
1.089303 
> confint(ft)
      2.5 %   97.5 %
x2 0.946718 1.230854
> ft <- free1way(y = y, groups = x, link = "probit", nbins = 100)
> coef(ft)
      x2 
1.087899 
> confint(ft)
     2.5 %   97.5 %
x2 0.94615 1.229993
> 
> 
> ### with offset
> mu <- 1
> off <- (x == levels(x)[2]) * mu
> 
> ci <- confint(m <- orm(y ~ x + offset(off)))
> c(rev(coef(m))[1], ci[nrow(ci),])
      x=2     2.5 %    97.5 % 
0.9212769 0.6796872 1.1628666 
> logLik(m)
'log Lik.' -6774.86 (df=1000)
> 
> ft <- free1way(y = y, groups = x, mu = 1)
> coef(ft)
       x2 
0.9213517 
> confint(ft)
       2.5 %  97.5 %
x2 0.6735414 1.16898
> logLik(m)
'log Lik.' -6774.86 (df=1000)
> ft <- free1way(y = y, groups = x, mu = 1, nbins = 99)
> coef(ft)
       x2 
0.9222895 
> confint(ft)
       2.5 %   97.5 %
x2 0.6848072 1.158645
> ft <- free1way(y = y, groups = x, mu = 1, nbins = 100)
> coef(ft)
       x2 
0.9202331 
> confint(ft)
       2.5 %  97.5 %
x2 0.6824928 1.15789
> 
> ### permutations
> N <- 15
> x <- gl(2, N)
> y <- rlogis(length(x), location = c(0, 2)[x])
> 
> ci <- confint(m <- orm(y ~ x))
> c(rev(coef(m))[1], ci[nrow(ci),])
       x=2      2.5 %     97.5 % 
 1.0671231 -0.2207782  2.3550243 
> logLik(m)
'log Lik.' -100.6793 (df=30)
> 
> ft <- free1way(y = y, groups = x)
> print(ft, test = "Wald")

	2-sample Wilcoxon test against proportional odds alternatives

data:  y by x (1, 2)
Wald chi-squared = 2.6373, df = 1, p-value = 0.1044
alternative hypothesis: true log-odds ratio is not equal to 0

> coef(ft)
      x2 
1.067117 
> confint(ft, test = "Wald")
        2.5 %   97.5 %
x2 -0.2207849 2.355019
> logLik(m)
'log Lik.' -100.6793 (df=30)
> print(ft, test = "Rao")

	2-sample Wilcoxon test against proportional odds alternatives

data:  y by x (1, 2)
Rao chi-squared = 2.6881, df = 1, p-value = 0.1011
alternative hypothesis: true log-odds ratio is not equal to 0

> confint(ft, test = "Rao")
        2.5 %  97.5 %
x2 -0.2034396 2.33921
> print(ft, test = "LRT")

	2-sample Wilcoxon test against proportional odds alternatives

data:  y by x (1, 2)
logLR chi-squared = 2.7131, df = 1, p-value = 0.09952
alternative hypothesis: true log-odds ratio is not equal to 0

> confint(ft, test = "LRT")
        2.5 %   97.5 %
x2 -0.2005976 2.392938
> print(ft, test = "Permutation")

	2-sample Wilcoxon test against proportional odds alternatives

data:  y by x (1, 2)
Perm Z = 1.5969, p-value = 0.1103
alternative hypothesis: true log-odds ratio is not equal to 0

> confint(ft, test = "Permutation")
        2.5 %   97.5 %
x2 -0.2363558 2.372363
> 
> ft <- free1way(y = y, groups = x, B = 10000)
> print(ft, test = "Permutation")

	2-sample Wilcoxon test against proportional odds alternatives

data:  y by x (1, 2)
Perm Z = 1.5969, p-value = 0.1166
alternative hypothesis: true log-odds ratio is not equal to 0

> confint(ft, test = "Permutation")
        2.5 %   97.5 %
x2 -0.2429805 2.352057
attr(,"Attained level")
[1] 0.95
> 
> proc.time()
   user  system elapsed 
 13.868   0.184  14.063 
