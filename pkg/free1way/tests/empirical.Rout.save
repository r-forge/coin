
R Under development (unstable) (2025-09-02 r88766) -- "Unsuffered Consequences"
Copyright (C) 2025 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> 
> library("free1way")
> library("rms")
Loading required package: Hmisc

Attaching package: 'Hmisc'

The following objects are masked from 'package:base':

    format.pval, units

> library("survival")
> options(digits = 5)
> set.seed(29)
> 
> N <- 500
> x <- gl(2, N)
> y <- rlogis(length(x), location = c(0, 2)[x])
> 
> ci <- confint(m <- orm(y ~ x))
> c(rev(coef(m))[1], ci[nrow(ci),])
   x=2  2.5 % 97.5 % 
1.9213 1.6797 2.1629 
> logLik(m)
'log Lik.' -6774.9 (df=1000)
> 
> d <- data.frame(y = y, x = x)
> 
> (ft <- free1way(y = y, groups = x))

	2-sample Wilcoxon test against proportional odds alternatives

data:  y by x (1, 2)
Perm Z = 15.6, p-value <2e-16
alternative hypothesis: true log-odds ratio is not equal to 0

> coef(ft)
    x2 
1.9213 
> confint(ft)
    2.5 % 97.5 %
x2 1.6724 2.1698
> logLik(ft)
[1] -6774.9
> (ft <- free1way(y ~ x, data = d))

	2-sample Wilcoxon test against proportional odds alternatives

data:  y by x (1, 2)
Perm Z = 15.6, p-value <2e-16
alternative hypothesis: true log-odds ratio is not equal to 0

> (ft <- free1way(y = y, groups = x, nbins = 99))

	2-sample Wilcoxon test against proportional odds alternatives

data:  y by x (1, 2)
Perm Z = 15.6, p-value <2e-16
alternative hypothesis: true log-odds ratio is not equal to 0

> (ft <- free1way(y = y, groups = x, nbins = 100))

	2-sample Wilcoxon test against proportional odds alternatives

data:  y by x (1, 2)
Perm Z = 15.6, p-value <2e-16
alternative hypothesis: true log-odds ratio is not equal to 0

> 
> -coef(m <- coxph(Surv(y, rep(TRUE, length(y))) ~ x))
     x2 
0.98652 
> -rev(confint(m))
[1] 0.85647 1.11657
> ### rms: cloglog for P(Y < y) is loglog for P(Y >= y), the latter
> ### being used in orm()
> ci <- confint(m <- orm(y ~ x, family = "loglog"))
> c(rev(coef(m))[1], ci[nrow(ci),])
    x=2   2.5 %  97.5 % 
0.98795 0.85789 1.11802 
> logLik(m)
'log Lik.' -6800 (df=1000)
> 
> ft <- free1way(y = y, groups = x, link = "cloglog")
> coef(ft)
     x2 
0.98789 
> confint(ft)
    2.5 % 97.5 %
x2 0.8389 1.1369
> logLik(ft)
[1] -6800
> ft <- free1way(y = y, groups = x, link = "cloglog", nbins = 99)
> coef(ft)
     x2 
0.99439 
> confint(ft)
     2.5 % 97.5 %
x2 0.84517 1.1435
> ft <- free1way(y = y, groups = x, link = "cloglog", nbins = 100)
> coef(ft)
     x2 
0.99328 
> confint(ft)
     2.5 % 97.5 %
x2 0.84403 1.1424
> 
> ci <- confint(m <- orm(y ~ x, family = "cloglog"))
> c(rev(coef(m))[1], ci[nrow(ci),])
    x=2   2.5 %  97.5 % 
0.94540 0.81641 1.07439 
> logLik(m)
'log Lik.' -6807.3 (df=1000)
> 
> ft <- free1way(y = y, groups = x, link = "loglog")
> coef(ft)
     x2 
0.94549 
> confint(ft)
    2.5 % 97.5 %
x2 0.7993 1.0915
> logLik(ft)
[1] -6807.3
> ft <- free1way(y = y, groups = x, link = "loglog", nbins = 99)
> coef(ft)
     x2 
0.95039 
> confint(ft)
     2.5 % 97.5 %
x2 0.80448 1.0965
> ft <- free1way(y = y, groups = x, link = "loglog", nbins = 100)
> coef(ft)
     x2 
0.95052 
> confint(ft)
     2.5 % 97.5 %
x2 0.80464 1.0967
> 
> ### probit
> ci <- confint(m <- orm(y ~ x, family = "probit"))
> c(rev(coef(m))[1], ci[nrow(ci),])
    x=2   2.5 %  97.5 % 
1.08725 0.95392 1.22059 
> logLik(m)
'log Lik.' -6779.2 (df=1000)
> 
> ft <- free1way(y = y, groups = x, link = "probit")
> coef(ft)
    x2 
1.0872 
> confint(ft)
     2.5 % 97.5 %
x2 0.94523 1.2293
> logLik(ft)
[1] -6779.2
> ft <- free1way(y = y, groups = x, link = "probit", nbins = 99)
> coef(ft)
    x2 
1.0893 
> confint(ft)
     2.5 % 97.5 %
x2 0.94672 1.2309
> ft <- free1way(y = y, groups = x, link = "probit", nbins = 100)
> coef(ft)
    x2 
1.0879 
> confint(ft)
     2.5 % 97.5 %
x2 0.94615   1.23
> 
> 
> ### with offset
> mu <- 1
> off <- (x == levels(x)[2]) * mu
> 
> ci <- confint(m <- orm(y ~ x + offset(off)))
> c(rev(coef(m))[1], ci[nrow(ci),])
    x=2   2.5 %  97.5 % 
0.92128 0.67969 1.16287 
> logLik(m)
'log Lik.' -6774.9 (df=1000)
> 
> ft <- free1way(y = y, groups = x, mu = 1)
> coef(ft)
     x2 
0.92135 
> confint(ft)
     2.5 % 97.5 %
x2 0.67354  1.169
> logLik(m)
'log Lik.' -6774.9 (df=1000)
> ft <- free1way(y = y, groups = x, mu = 1, nbins = 99)
> coef(ft)
     x2 
0.92229 
> confint(ft)
     2.5 % 97.5 %
x2 0.68481 1.1586
> ft <- free1way(y = y, groups = x, mu = 1, nbins = 100)
> coef(ft)
     x2 
0.92023 
> confint(ft)
     2.5 % 97.5 %
x2 0.68249 1.1579
> 
> ### permutations
> N <- 15
> x <- gl(2, N)
> y <- rlogis(length(x), location = c(0, 2)[x])
> 
> ci <- confint(m <- orm(y ~ x))
> c(rev(coef(m))[1], ci[nrow(ci),])
     x=2    2.5 %   97.5 % 
 1.06712 -0.22078  2.35502 
> logLik(m)
'log Lik.' -100.68 (df=30)
> 
> ft <- free1way(y = y, groups = x)
> print(ft, test = "Wald")

	2-sample Wilcoxon test against proportional odds alternatives

data:  y by x (1, 2)
Wald chi-squared = 2.64, df = 1, p-value = 0.1
alternative hypothesis: true log-odds ratio is not equal to 0

> coef(ft)
    x2 
1.0671 
> confint(ft, test = "Wald")
      2.5 % 97.5 %
x2 -0.22078  2.355
> logLik(m)
'log Lik.' -100.68 (df=30)
> print(ft, test = "Rao")

	2-sample Wilcoxon test against proportional odds alternatives

data:  y by x (1, 2)
Rao chi-squared = 2.69, df = 1, p-value = 0.1
alternative hypothesis: true log-odds ratio is not equal to 0

> confint(ft, test = "Rao")
      2.5 % 97.5 %
x2 -0.20344 2.3392
> print(ft, test = "LRT")

	2-sample Wilcoxon test against proportional odds alternatives

data:  y by x (1, 2)
logLR chi-squared = 2.71, df = 1, p-value = 0.1
alternative hypothesis: true log-odds ratio is not equal to 0

> confint(ft, test = "LRT")
     2.5 % 97.5 %
x2 -0.2006 2.3929
> print(ft, test = "Permutation")

	2-sample Wilcoxon test against proportional odds alternatives

data:  y by x (1, 2)
Perm Z = 1.6, p-value = 0.11
alternative hypothesis: true log-odds ratio is not equal to 0

> confint(ft, test = "Permutation")
      2.5 % 97.5 %
x2 -0.23636 2.3724
> 
> ft <- free1way(y = y, groups = x, B = 10000)
> print(ft, test = "Permutation")

	2-sample Wilcoxon test against proportional odds alternatives

data:  y by x (1, 2)
Perm Z = 1.6, p-value = 0.12
alternative hypothesis: true log-odds ratio is not equal to 0

> confint(ft, test = "Permutation")
      2.5 % 97.5 %
x2 -0.24298 2.3521
attr(,"Attained level")
[1] 0.95
> 
> proc.time()
   user  system elapsed 
  5.038   0.092   5.125 
